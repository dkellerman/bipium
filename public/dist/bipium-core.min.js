var Bipium;(()=>{var t={693:function(t,e){"use strict";var i=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))((function(s,n){function o(t){try{u(r.next(t))}catch(t){n(t)}}function a(t){try{u(r.throw(t))}catch(t){n(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Clicker=e.DEFAULT_SOUNDS=void 0,e.DEFAULT_SOUNDS={name:"Defaults",bar:880,beat:440,subDiv:220,user:660};function r(t,e){return i(this,void 0,void 0,(function*(){const i=yield fetch(e),r=yield i.arrayBuffer();return yield t.decodeAudioData(r)}))}e.Clicker=class{constructor(t){let{audioContext:i,volume:r=100,sounds:s=e.DEFAULT_SOUNDS}=t;this.sounds={},this.audioContext=i,this.volume=r,this.loading=!1,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination),this.setSounds(s)}setSounds(t){return i(this,void 0,void 0,(function*(){this.sounds=yield this.fetchSounds(t)}))}fetchSounds(t){return i(this,void 0,void 0,(function*(){this.loading=!0;for(const e in t){if("name"===e)continue;let i;if(Array.isArray(t[e])?i=t[e][0]:(i=t[e],t[e]=[i,1,.05]),"string"==typeof i){const s=yield r(this.audioContext,i);t[e][0]=s}}return this.loading=!1,t}))}setVolume(t){this.volume=t}scheduleClickSound(t){let e,{time:i,subDiv:r,beat:s,beats:n}=t;if(this.loading)return;const o=this.sounds;e=1===s&&1===r?o.bar||o.beat:s===Math.ceil(n/2)+1&&1===r?o.half||o.beat:s>1&&1===r?o.beat:o.subDiv||o.beat;const[a,u,l]=e;return this.playSoundAt(a,i,l,u)}removeClickSound(t){var e;null===(e=null==t?void 0:t.obj)||void 0===e||e.stop(0)}playSoundAt(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;var s;let n;if("suspended"===(null===(s=this.audioContext)||void 0===s?void 0:s.state)&&this.audioContext.resume(),"number"==typeof t)n=this.audioContext.createOscillator(),n.connect(this.gainNode),n.frequency.value=t,n.start(e),n.stop(e+i);else{n=this.audioContext.createBufferSource();try{n.buffer=t}catch(t){console.error(t)}n.connect(this.gainNode),n.start(e,0,i)}return this.gainNode.gain.setValueAtTime(this.volume*r/100,e),n}click(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const[e,i,r]=this.sounds.user;return this.playSoundAt(e,t,r,i)}}},587:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Metronome=void 0;const i={bpm:80,beats:4,subDivs:1,swing:0,workerUrl:void 0,lookaheadInterval:.025,scheduleAheadTime:.1,startDelayTime:.2};e.Metronome=class{constructor(t){this.started=!1,this.startTime=0,this.barStart=0,this.lastBar=0,this.scheduledClicks=[],this.opts=Object.assign(Object.assign({},i),t),this.started=!1,this.next={bar:0,beat:0,beats:this.opts.beats,subDiv:0,subDivs:this.opts.subDivs,time:0},this.opts.workerUrl?this.worker=new Worker(this.opts.workerUrl):this.worker=new r,this.worker.onmessage=t=>{var e,i;"tick"===t.data&&(this.scheduler(),null===(i=(e=this.opts).onSchedulerTick)||void 0===i||i.call(e))},this.worker.postMessage({interval:this.opts.lookaheadInterval})}start(){var t,e,i,r;this.started||(this.startTime=this.now+this.opts.startDelayTime,this.stopTime=void 0,this.barStart=this.startTime,this.lastBar=0,this.started=!0,this.scheduledClicks=[],this.opts.subDivs%2>0&&(this.opts.swing=0),this.next={bar:1,beat:1,beats:this.opts.beats,subDiv:1,subDivs:this.opts.subDivs,time:this.startTime},this.worker.postMessage("start"),null===(e=(t=this.opts).onStart)||void 0===e||e.call(t),"suspended"===(null===(r=null===(i=this.opts.clicker)||void 0===i?void 0:i.audioContext)||void 0===r?void 0:r.state)&&this.opts.clicker.audioContext.resume())}stop(){var t,e;this.started&&(this.stopTime=this.now,this.started=!1,this.worker.postMessage("stop"),this.unscheduleClicks(),null===(e=(t=this.opts).onStop)||void 0===e||e.call(t))}update(t){let{bpm:e,beats:i,subDivs:r,swing:s}=t;var n,o;if(this.unscheduleClicks(),void 0!==e&&(this.opts.bpm=e),void 0!==i&&(this.opts.beats=i),void 0!==r&&(this.opts.subDivs=r),void 0!==s&&(this.opts.swing=s),(void 0!==e||void 0!==i)&&this.started&&this.scheduledClicks.length){for(this.lastClick&&(this.next=Object.assign({},this.lastClick));this.next.time<=this.now-this.subDivTime;)this.next.time+=this.subDivTime;this.advance()}null===(o=(n=this.opts).onUpdateOptions)||void 0===o||o.call(n,this.opts)}scheduler(){if(!this.started)return;const t=this.lastClick;for(t&&(t.bar||0)>this.lastBar&&(this.lastBar=t.bar,this.barStart=t.time);this.next.time<this.now+this.opts.scheduleAheadTime;)this.scheduleClick(),this.advance()}scheduleClick(){var t,e,i;const r=Object.assign(Object.assign({},this.next),{beats:this.opts.beats,subDivs:this.opts.subDivs}),s=null===(t=this.opts.clicker)||void 0===t?void 0:t.scheduleClickSound(r);null===(i=(e=this.opts).onNextClick)||void 0===i||i.call(e,r),this.scheduledClicks.push(Object.assign(Object.assign({},r),{obj:s}));const n=this.now;this.scheduledClicks=this.scheduledClicks.filter((t=>(null==t?void 0:t.time)>=n-10))}advance(){let t=this.beatTime/this.opts.subDivs;this.next.subDiv%2==1?t+=t*(this.opts.swing/100):t*=(100-this.opts.swing)/100,this.next.time+=t,this.next.subDiv%this.opts.subDivs==0?(this.next.subDiv=1,this.next.beat++,this.next.beat>this.opts.beats&&(this.next.beat=1,this.next.bar++)):this.next.subDiv++}unscheduleClicks(){this.scheduledClicks=(this.scheduledClicks||[]).map((t=>{var e,i,r;return t.time>this.now?(null===(e=this.opts.clicker)||void 0===e||e.removeClickSound(t),null===(r=(i=this.opts).onUnscheduleClick)||void 0===r||r.call(i,t),null):t})).filter(Boolean)}get now(){return this.opts.timerFn()}get beatTime(){return 60/this.opts.bpm}get subDivTime(){return this.beatTime/this.opts.subDivs}get barTime(){return this.opts.beats*this.beatTime}get totalSubDivs(){return this.opts.beats*this.opts.subDivs}get gridTimes(){const t=this.barTime/this.totalSubDivs*(this.opts.swing/100)||0;return Array.from(Array(this.totalSubDivs).keys()).map((e=>{const i=e*(this.barTime/this.totalSubDivs);return e%2==1?i+t:i}))}get elapsed(){return this.now-this.startTime}get lastClick(){var t;const e=null===(t=this.scheduledClicks)||void 0===t?void 0:t.filter((t=>t.time<=this.now));return(null==e?void 0:e[e.length-1])||null}getClickIndex(t,e){return t?(t.bar-1)*this.opts.beats+(t.beat-1)*(null!=e?e:this.opts.subDivs)+(t.subDiv-1):-1}getClickBarIndex(t,e){return(t.beat-1)*(null!=e?e:this.opts.subDivs)+(t.subDiv-1)}quantize(t,e){const i=null!=e?e:this.opts.subDivs,r=t-this.barStart,s=this.gridTimes.concat([this.barTime]).filter(((t,e)=>e%(this.opts.subDivs/i)==0)),n=s.reduce(((t,e)=>Math.abs(e-r)<Math.abs(t-r)?e:t)),o=n-r;let a=s.indexOf(n);return a===this.opts.beats*i&&(a=0),a++,[o,a]}};class r{onmessage(t){}postMessage(t){"object"==typeof t&&t.interval?(this.interval=t.interval,this.clearTimer()):"start"===t?(this.startTimer(),this.tick()):"stop"===t&&this.clearTimer()}startTimer(){this.interval&&(this.timer=setInterval(this.tick.bind(this),1e3*this.interval))}clearTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)}tick(){this.onmessage({data:"tick"})}}},110:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Visualizer=void 0;const i={qThreshold:.04};class r{constructor(t){this.progress=0,this.lastTime=0,this.savedClick=null,this.count=[],this.qType=null,this.userClicks=[],this.opts=Object.assign(Object.assign({},i),t)}start(){this.progress=0,this.lastTime=0,this.savedClick=this.opts.metronome.lastClick,this.count=[],this.qType=null,this.userClicks=[]}stop(){this.progress=0,this.count=[],this.userClicks=[],this.savedClick=null,this.qType=null}update(){const{savedClick:t,lastTime:e,userClicks:i}=this,s=this.opts.metronome,n=s.elapsed-e;if(r.frameRate.push(n),r.frameRate.length>100&&r.frameRate.shift(),!s.started||s.elapsed<0)return;const o=s.getClickIndex(t),a=s.lastClick,u=s.getClickIndex(a,null==t?void 0:t.subDivs);if(a&&u>o){this.savedClick=a;const t=s.getClickBarIndex(a);this.progress=1/s.totalSubDivs*t,t%2==1&&(this.progress+=1/s.totalSubDivs*(s.opts.swing/100))}else{const t=this.progress,e=1-t,i=n*(e/(s.barTime*e));this.progress=(t+i)%1}this.lastTime=s.elapsed;let l=(null==a?void 0:a.beat)||1,h=(null==a?void 0:a.subDiv)||1;if(this.count=s.opts.subDivs>1?[l,h]:[l],null==i?void 0:i.length){const t=i.pop();for(;i.length;)i.pop();const[e]=s.quantize(t,1);this.qType=(c=e,d=this.opts.qThreshold,c<=-1*d?"late":c>=d?"early":"ontime")}var c,d}static get frameRateInfo(){const t=r.frameRate;if(!(null==t?void 0:t.length))return 0;const e=t.reduce(((t,e)=>t+e))/t.length,i=Math.sqrt(t.map((t=>Math.pow(t-e,2))).reduce(((t,e)=>t+e))/t.length);return{mean:e,std:i}}}e.Visualizer=r,r.frameRate=[]},523:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Visualizer=e.DEFAULT_SOUNDS=e.Clicker=e.Metronome=e.createMetronome=void 0;const r=i(587),s=i(693);e.createMetronome=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new AudioContext;const n=new s.Clicker(Object.assign({audioContext:i},e));return new r.Metronome(Object.assign({timerFn:()=>i.currentTime,clicker:n},t))};var n=i(587);Object.defineProperty(e,"Metronome",{enumerable:!0,get:function(){return n.Metronome}});var o=i(693);Object.defineProperty(e,"Clicker",{enumerable:!0,get:function(){return o.Clicker}}),Object.defineProperty(e,"DEFAULT_SOUNDS",{enumerable:!0,get:function(){return o.DEFAULT_SOUNDS}});var a=i(110);Object.defineProperty(e,"Visualizer",{enumerable:!0,get:function(){return a.Visualizer}})},666:t=>{var e=function(t){"use strict";var e,i=Object.prototype,r=i.hasOwnProperty,s=Object.defineProperty||function(t,e,i){t[e]=i.value},n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",u=n.toStringTag||"@@toStringTag";function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,i){return t[e]=i}}function h(t,e,i,r){var n=e&&e.prototype instanceof m?e:m,o=Object.create(n.prototype),a=new _(r||[]);return s(o,"_invoke",{value:S(t,i,a)}),o}function c(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var d="suspendedStart",v="suspendedYield",p="executing",f="completed",b={};function m(){}function g(){}function y(){}var k={};l(k,o,(function(){return this}));var w=Object.getPrototypeOf,x=w&&w(w(E([])));x&&x!==i&&r.call(x,o)&&(k=x);var C=y.prototype=m.prototype=Object.create(k);function D(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function i(s,n,o,a){var u=c(t[s],t,n);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){l.value=t,o(l)}),(function(t){return i("throw",t,o,a)}))}a(u.arg)}var n;s(this,"_invoke",{value:function(t,r){function s(){return new e((function(e,s){i(t,r,e,s)}))}return n=n?n.then(s,s):s()}})}function S(t,e,i){var r=d;return function(s,n){if(r===p)throw new Error("Generator is already running");if(r===f){if("throw"===s)throw n;return M()}for(i.method=s,i.arg=n;;){var o=i.delegate;if(o){var a=O(o,i);if(a){if(a===b)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===d)throw r=f,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=p;var u=c(t,e,i);if("normal"===u.type){if(r=i.done?f:v,u.arg===b)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r=f,i.method="throw",i.arg=u.arg)}}}function O(t,i){var r=i.method,s=t.iterator[r];if(s===e)return i.delegate=null,"throw"===r&&t.iterator.return&&(i.method="return",i.arg=e,O(t,i),"throw"===i.method)||"return"!==r&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var n=c(s,t.iterator,i.arg);if("throw"===n.type)return i.method="throw",i.arg=n.arg,i.delegate=null,b;var o=n.arg;return o?o.done?(i[t.resultName]=o.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,b):o:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,b)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function E(t){if(t){var i=t[o];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var s=-1,n=function i(){for(;++s<t.length;)if(r.call(t,s))return i.value=t[s],i.done=!1,i;return i.value=e,i.done=!0,i};return n.next=n}}return{next:M}}function M(){return{value:e,done:!0}}return g.prototype=y,s(C,"constructor",{value:y,configurable:!0}),s(y,"constructor",{value:g,configurable:!0}),g.displayName=l(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,u,"GeneratorFunction")),t.prototype=Object.create(C),t},t.awrap=function(t){return{__await:t}},D(T.prototype),l(T.prototype,a,(function(){return this})),t.AsyncIterator=T,t.async=function(e,i,r,s,n){void 0===n&&(n=Promise);var o=new T(h(e,i,r,s),n);return t.isGeneratorFunction(i)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},D(C),l(C,u,"Generator"),l(C,o,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),i=[];for(var r in e)i.push(r);return i.reverse(),function t(){for(;i.length;){var r=i.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=E,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function s(r,s){return a.type="throw",a.arg=t,i.next=r,s&&(i.method="next",i.arg=e),!!s}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],a=o.completion;if("root"===o.tryLoc)return s("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return s(o.catchLoc,!0);if(this.prev<o.finallyLoc)return s(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return s(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return s(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i];if(s.tryLoc<=this.prev&&r.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var n=s;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var o=n?n.completion:{};return o.type=t,o.arg=e,n?(this.method="next",this.next=n.finallyLoc,b):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),L(i),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var r=i.completion;if("throw"===r.type){var s=r.arg;L(i)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,r){return this.delegate={iterator:E(t),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=e),b}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}},e={};function i(r){var s=e[r];if(void 0!==s)return s.exports;var n=e[r]={exports:{}};return t[r].call(n.exports,n,n.exports,i),n.exports}i(666);var r=i(523);Bipium=r})();